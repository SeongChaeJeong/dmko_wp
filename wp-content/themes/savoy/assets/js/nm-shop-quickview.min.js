/* NM: Quick-view script */
(function(b){b.extend(b.nmTheme,{quickview_init:function(){var a=this,g=b("#nm-quickview"),c=b('<div id="nm-quickview-overlay" class="mfp-bg nm-mfp-fade-in"></div>'),f;if("1"==nm_wp_vars.quickviewLinks.link)a.$body.on("click",".nm-quickview-btn",function(a){a.preventDefault();d(this)});if("1"==nm_wp_vars.quickviewLinks.thumb)a.$body.on("click",".nm-shop-loop-thumbnail-link",function(a){a.preventDefault();d(this)});if("1"==nm_wp_vars.quickviewLinks.title)a.$body.on("click",".nm-shop-loop-title-link",
function(a){a.preventDefault();d(this)});var d=function(e){e=b(e);(f=(f=e.data("product-id"))?f:e.closest(".product").data("product-id"))?(a.$html.css("width","auto"),c.appendTo(a.$body),c.addClass("show mfp-ready nm-loader"),h()):console.log("NM: Error - _qvClick() - No product ID found")},h=function(){var e={product_id:f};if("undefined"!==typeof wc_add_to_cart_params)var d=wc_add_to_cart_params.wc_ajax_url.toString().replace("%%endpoint%%","nm_ajax_load_product");else d=nm_wp_vars.ajaxUrl,e.action=
"nm_ajax_load_product";window.nm_quickview_get_product=b.ajax({type:"POST",url:d,data:e,dataType:"html",cache:!1,headers:{"cache-control":"no-cache"},beforeSend:function(){"object"===typeof window.nm_quickview_get_product&&window.nm_quickview_get_product.abort()},error:function(b,e,d){console.log("NM: AJAX error - _qvLoadProduct() - "+d);a.$html.css("width","");c.removeClass("mfp-ready mfp-removing").remove()},success:function(e){g.html(e);var d=g.children("#product-"+f),c=d.find("form.cart");b("#nm-quickview-slider").find("img").last().one("load",
function(){d.hasClass("product-variable")&&(c.wc_variation_form().find(".variations select:eq(0)").change(),a.singleProductVariationsInit(c),c.on("woocommerce_variation_select_change",function(){a.qvHasSlider&&a.$qvSlider.slick("slickGoTo",0,!1)}));a.quantityInputsBindButtons(b("#nm-qv-product-summary"));k()})}})},k=function(){b.magnificPopup.open({mainClass:"nm-mfp-quickview nm-mfp-fade-in",closeMarkup:'<a class="mfp-close nm-font nm-font-close2"></a>',removalDelay:180,items:{src:g,type:"inline"},
callbacks:{open:function(){c.removeClass("nm-loader");a.qvHasSlider=!1;a.$qvSlider=b("#nm-quickview-slider");1<a.$qvSlider.children().length&&(a.qvHasSlider=!0,a.$qvSlider.slick({prevArrow:'<a class="slick-prev"><i class="nm-font nm-font-angle-left"></i></a>',nextArrow:'<a class="slick-next"><i class="nm-font nm-font-angle-right"></i></a>',dots:!1,infinite:!1,speed:350}));c.one("touchstart.qv",function(){b.magnificPopup.close()})},beforeClose:function(){c.addClass("mfp-removing")},close:function(){a.$html.css("width",
"");c.removeClass("mfp-ready mfp-removing").remove()}}})}}});b.nmThemeExtensions.quickview=b.nmTheme.quickview_init})(jQuery);